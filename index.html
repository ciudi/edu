<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz – Set nou</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; max-width: 900px; margin: 24px auto; padding: 0 16px; }
    .topbar { display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
    .badge { display:inline-block; padding:6px 10px; border:1px solid #ddd; border-radius:999px; font-size:14px; }
    .card { border:1px solid #e5e5e5; border-radius:14px; padding:16px; margin:14px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.04); }
    h1 { margin: 0 0 10px; font-size: 22px; }
    h2 { margin: 0 0 10px; font-size: 18px; line-height: 1.35; }
    .choices { margin: 10px 0; }
    .choice { display:flex; gap:10px; padding:10px; border:1px solid #eee; border-radius:12px; margin:8px 0; cursor:pointer; }
    .choice:hover { background: #fafafa; }
    .choice input { margin-top: 3px; }
    button { padding:10px 14px; border-radius:12px; border:1px solid #ddd; background:white; cursor:pointer; font-weight:600; }
    button:hover { background:#f6f6f6; }
    button.primary { background:#111; color:#fff; border-color:#111; }
    button.primary:hover { background:#222; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    .muted { opacity:.75; }
    .result { padding: 12px; border-radius: 12px; border: 1px solid #e9e9e9; background: #fbfbfb; margin-top: 12px; }
    .ok { border-color: #cfead6; background: #f3fbf5; }
    .bad { border-color: #ffd0d0; background: #fff5f5; }
    .timer { font-variant-numeric: tabular-nums; }
    .progress { height: 10px; background: #eee; border-radius: 999px; overflow:hidden; margin-top: 10px; }
    .progress > div { height:100%; width:0%; background:#111; transition: width .2s linear; }
    .footer { margin-top: 18px; display:flex; justify-content:space-between; gap: 12px; flex-wrap:wrap; }
    .small { font-size: 13px; }
    code { background:#f6f6f6; padding:2px 6px; border-radius:8px; }
    a { color: inherit; text-decoration: underline; }
    .emph { font-weight: 700; text-decoration: underline; }
  </style>
</head>
<body>

<h1>Quiz – Set nou</h1>

<div class="topbar">
  <div class="badge" id="qCounter">Întrebarea 1 / 1</div>
  <div class="badge timer" id="timerBadge">⏳ Timp rămas: <span id="timeLeft">30</span>s</div>
</div>
<div class="progress" id="progressWrap"><div id="timeBar"></div></div>

<div id="app" class="card"></div>

<script>
  // === Întrebări (set nou) ===
  const questions = [
    {
      "question": "În cuvântul „ceașcă”, numărul de litere și de sunete este:",
      "choices": ["6 litere și 6 sunete", "6 litere și 5 sunete", "6 litere și 4 sunute", "5 litere și 5 sunete"],
      "answerIndex": 1,
      "explanation": "Grupul „ce” urmat de o vocală („a”) notează un singur sunet (consoana [č]), deci cuvântul are 6 litere, dar 5 sunete."
    },
    {
      "question": "Identifică procedeul prin care s-a format cuvântul evidențiat în enunțul: „Fratele său ne-a făcut un **bine**.”",
      "choices": ["Derivare", "Compunere", "Conversiune", "Împrumut"],
      "answerIndex": 2,
      "explanation": "Adverbul „bine” a devenit substantiv prin articulare cu articolul nehotărât „un”, proces numit conversiune."
    },
    {
      "question": "În poezia „Izvorul nopții” de Lucian Blaga (Link text: https://ro.wikisource.org/wiki/Izvorul_nop%C8%9Bii), metafora „**izvorul nopții**” face referire la:",
      "choices": ["Ochii iubitei", "Lumina lunii", "Un râu de munte", "Părul iubitei"],
      "answerIndex": 0,
      "explanation": "Metafora centrală a poeziei asociază ochii negri ai iubitei cu un izvor din care curge noaptea peste lume."
    },
    {
      "question": "Alege forma corectă a verbului la imperativ negativ: „Nu **face** gălăgie!” vs „Nu **fă** gălăgie!”",
      "choices": ["Nu face", "Nu fă"],
      "answerIndex": 0,
      "explanation": "Imperativul negativ la persoana a II-a singular se formează cu „nu” + infinitivul verbului (a face -> Nu face!). Forma „Nu fă” este incorectă."
    },
    {
      "question": "În enunțul „**Lunea** merg la antrenament”, cuvântul evidențiat este:",
      "choices": ["Substantiv comun", "Adverb de timp", "Adjectiv", "Numeral"],
      "answerIndex": 1,
      "explanation": "Deși provine dintr-un substantiv, „Lunea” răspunde la întrebarea „când?” și exprimă repetabilitatea, devenind adverb de timp prin conversiune."
    },
    {
      "question": "Indicațiile scenice (didascaliile) dintr-un text dramatic au rolul de a:",
      "choices": ["Reda replicile personajelor", "Oferi informații pentru jocul actorilor și decor", "Povesti acțiunea în detaliu", "Caracteriza direct personajele exclusiv"],
      "answerIndex": 1,
      "explanation": "Didascaliile sunt instrucțiunile autorului (non-literare) adresate regizorului și actorilor privind decorul, mimica sau gesturile."
    },
    {
      "question": "Termenul argotic „**bișniță**” provine din limba:",
      "choices": ["Franceză", "Engleză", "Germană", "Turcă"],
      "answerIndex": 1,
      "explanation": "Provine din englezescul „business”, adaptat fonetic și semantic în registrul argotic."
    },
    {
      "question": "În versul „Prin vulturi **v**ântul **v**iu **v**uia” („Nunta Zamfirei” - G. Coșbuc), repetiția consoanei „v” este o:",
      "choices": ["Asonanță", "Aliterație", "Metaforă", "Personificare"],
      "answerIndex": 1,
      "explanation": "Aliterația constă în repetarea unei consoane pentru a crea un efect sonor imitativ (aici, sunetul vântului)."
    },
    {
      "question": "Propoziția „Ea **este** profesoară” conține un verb:",
      "choices": ["Predicativ", "Copulativ", "Auxiliar", "Impersonal"],
      "answerIndex": 1,
      "explanation": "Verbul „a fi” nu are sens de sine stătător (nu înseamnă „a exista”), ci face legătura cu numele predicativ „profesoară”, fiind copulativ."
    },
    {
      "question": "În enunțul „Am ajuns **înaintea** colegilor”, cuvântul evidențiat este:",
      "choices": ["Adverb", "Prepoziție specifică genitivului", "Prepoziție specifică dativului", "Substantiv"],
      "answerIndex": 1,
      "explanation": "„Înaintea” este o prepoziție provenită din adverb care cere cazul Genitiv (înaintea cui? -> a colegilor)."
    },
    {
      "question": "Care este forma corectă de plural pentru substantivul „aragaz”?",
      "choices": ["Aragaze", "Aragazuri"],
      "answerIndex": 1,
      "explanation": "Conform normelor actuale (DOOM), pluralul corect al substantivului neutru „aragaz” este „aragazuri”."
    },
    {
      "question": "În fraza „Nu vorbește, **nici** nu cântă”, cuvântul „nici” este:",
      "choices": ["Adverb de negație", "Conjuncție coordonatoare copulativă", "Conjuncție coordonatoare adversativă", "Prepoziție"],
      "answerIndex": 1,
      "explanation": "„Nici” leagă două propoziții de același fel (negative), având rol de conjuncție copulativă."
    },
    {
      "question": "Cuvintele „**cefalee**” (durere de cap) sau „**morfem**” fac parte din:",
      "choices": ["Limbajul familiar", "Argou", "Jargon (limbaj specializat)", "Limbajul popular"],
      "answerIndex": 2,
      "explanation": "Sunt termeni tehnici specifici unor domenii (medicină, lingvistică), încadrându-se în jargon."
    },
    {
      "question": "În versurile „Argintu **mușcă** / Iarba...” („Luna” - Șt. A. Doinaș), figura de stil este:",
      "choices": ["Epitet", "Personificare", "Comparație", "Hiperbolă"],
      "answerIndex": 1,
      "explanation": "Atribuirea unei acțiuni specifice unei ființe vii („mușcă”) unui element neînsuflețit („argintul”/lumina lunii) este o personificare."
    },
    {
      "question": "Grupul de sunete din cuvântul „**toam**-nă” (oa) este un:",
      "choices": ["Hiat", "Diftong", "Triftong", "Nu formează grup vocalic"],
      "answerIndex": 1,
      "explanation": "Vocala 'a' și semivocala 'o' sunt pronunțate în aceeași silabă, formând un diftong."
    },
    {
      "question": "În propoziția „Succesul este **grație** muncii”, cuvântul evidențiat s-a format prin conversiune din:",
      "choices": ["Verb", "Adjectiv", "Substantiv", "Adverb"],
      "answerIndex": 2,
      "explanation": "Prepoziția „grație” (cu sensul de „datorită”) provine din substantivul „grație” (eleganță/iertare)."
    },
    {
      "question": "Versurile fără rimă, dar care păstrează ritmul și măsura, se numesc:",
      "choices": ["Versuri libere", "Versuri albe", "Distih", "Monorimă"],
      "answerIndex": 1,
      "explanation": "Versul alb respectă metrica clasică (ritm, măsură), dar nu are rimă, spre deosebire de versul liber care nu respectă nicio constrângere."
    },
    {
      "question": "Alege varianta corectă: „Serviciul de **reparații** televizoare.” / „Serviciul de **reparări** televizoare.”",
      "choices": ["Reparații", "Reparări"],
      "answerIndex": 0,
      "explanation": "Forma consacrată pentru pluralul substantivului care denumește atelierul/acțiunea este „reparații”."
    },
    {
      "question": "În enunțul „M-am întâlnit cu **un** coleg”, cuvântul „un” este:",
      "choices": ["Numeral cardinal", "Articol nehotărât", "Pronume nehotărât", "Adjectiv"],
      "answerIndex": 1,
      "explanation": "Însoțește un substantiv fără a insista pe număr (nu îl opune lui „doi”), având valoare de articol nehotărât."
    },
    {
      "question": "Ce rol are cratima în structura „**show-ul**”?",
      "choices": ["Leagă două cuvinte diferite", "Marchează elidarea unei vocale", "Leagă articolul hotărât de un împrumut neadaptat", "Este opțională"],
      "answerIndex": 2,
      "explanation": "La împrumuturile a căror finală pronunțată diferă de cea scrisă (show [șou]), articolul hotărât se leagă prin cratimă."
    },
    {
      "question": "În propoziția „El **se** spală”, pronumele „se” este în cazul:",
      "choices": ["Dativ", "Acuzativ", "Nominativ", "Genitiv"],
      "answerIndex": 1,
      "explanation": "Răspunde la întrebarea „pe cine spală?” -> „pe sine” (se). Este un pronume reflexiv în cazul Acuzativ."
    },
    {
      "question": "Cuvântul „**picior**” în expresia „la piciorul podului” este folosit cu sens:",
      "choices": ["Propriu de bază", "Propriu secundar", "Figurat (metaforic)", "Argotic"],
      "answerIndex": 1,
      "explanation": "Sensul propriu secundar apare prin asemănare de formă sau poziție cu sensul de bază, fără a fi o figură de stil poetică."
    },
    {
      "question": "În fraza „Mergem la munte, **dar** nu schiem”, raportul de coordonare este:",
      "choices": ["Copulativ", "Adversativ", "Disjunctiv", "Concluziv"],
      "answerIndex": 1,
      "explanation": "Conjuncția „dar” introduce o opoziție față de propoziția anterioară, stabilind un raport adversativ."
    },
    {
      "question": "Valoarea morfologică a cuvântului „**rănit**” în enunțul „Un rănit a fost transportat la spital” este:",
      "choices": ["Verb la participiu", "Adjectiv", "Substantiv", "Adverb"],
      "answerIndex": 2,
      "explanation": "Prin articulare cu „un”, participiul „rănit” a devenit substantiv (denumește persoana)."
    },
    {
      "question": "În versul „Și vodă-i un **munte**” („Pașa Hassan” - G. Coșbuc), termenul „munte” este o metaforă hiperbolizată care sugerează:",
      "choices": ["Mărimea fizică a domnitorului", "Forța copleșitoare și măreția voievodului", "Faptul că stătea pe un munte", "Indiferența personajului"],
      "answerIndex": 1,
      "explanation": "Hiperbola „vodă-i un munte” exagerează dimensiunile pentru a sugera forța morală și statura impunătoare a lui Mihai Viteazul în fața dușmanului."
    }
  ];

  const app = document.getElementById("app");
  const qCounter = document.getElementById("qCounter");
  const timeBar = document.getElementById("timeBar");
  const timerBadge = document.getElementById("timerBadge");
  const progressWrap = document.getElementById("progressWrap");

  const DEFAULT_TIME_PER_Q = 30;

  let idx = 0;
  let score = 0;
  let timer = null;
  let remaining = DEFAULT_TIME_PER_Q;
  let locked = false;

  function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

  function grade1to10(correct, total) {
    if (total <= 0) return 1;
    const ratio = correct / total;
    const g = 1 + ratio * 9; // 0% -> 1, 100% -> 10
    return Math.round(g * 100) / 100;
  }

  function stopTimer(){
    if (timer) { clearInterval(timer); timer = null; }
  }

  // întrebările cu "Link text:" -> timp infinit
  function questionHasLinkText(q) {
    return /Link text:\s*https?:\/\/[^\s)]+/.test(q);
  }

  function setInfiniteTimerUI(){
    stopTimer();
    timerBadge.innerHTML = `⏳ Timp: <span id="timeLeft">∞</span>`;
    progressWrap.style.display = "none";
  }

  function startTimer(seconds){
    stopTimer();
    remaining = seconds;
    progressWrap.style.display = "block";
    timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">${remaining}</span>s`;
    timeBar.style.width = "100%";

    timer = setInterval(() => {
      remaining -= 1;
      const tl = document.getElementById("timeLeft");
      if (tl) tl.textContent = remaining;

      const pct = (remaining / seconds) * 100;
      timeBar.style.width = clamp(pct, 0, 100) + "%";

      if (remaining <= 0) {
        stopTimer();
        revealAnswer(null, true);
      }
    }, 1000);
  }

  function formatQuestionText(raw) {
    let text = raw;

    // **...** -> bold + underline
    text = text.replace(/\*\*(.+?)\*\*/g, '<span class="emph">$1</span>');

    // (Link text: URL) -> link + spațiu înainte de ")"
    text = text.replace(
      /\(Link text:\s*(https?:\/\/[^\s)]+)\)/g,
      (m, url) => `(Link text: <a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a> )`
    );

    // Link text: URL (cu punctuație după) -> link
    text = text.replace(
      /Link text:\s*(https?:\/\/[^\s),.]+)([),.]?)/g,
      (m, url, punct) => `Link text: <a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a>${punct || ""}`
    );

    return text;
  }

  function renderQuestion(){
    locked = false;
    const q = questions[idx];
    qCounter.textContent = `Întrebarea ${idx + 1} / ${questions.length}`;

    const hasLink = questionHasLinkText(q.question);

    app.innerHTML = `
      <h2>${formatQuestionText(q.question)}</h2>
      <div class="choices">
        ${q.choices.map((c, i) => `
          <label class="choice">
            <input type="radio" name="choice" value="${i}">
            <span>${c}</span>
          </label>
        `).join("")}
      </div>
      <div class="row">
        <button class="primary" id="submitBtn">Trimite răspuns</button>
        <button id="skipBtn">Nu știu / sari</button>
      </div>
      <div id="feedback"></div>
      <div class="footer small muted">
        <div>Scor curent: <b id="scoreNow">${score}</b> / ${questions.length}</div>
        <div>${hasLink ? `Timp / întrebare: <code>∞</code>` : `Timp / întrebare: <code>${DEFAULT_TIME_PER_Q}s</code>`}</div>
      </div>
    `;

    document.getElementById("submitBtn").onclick = () => {
      if (locked) return;
      const picked = app.querySelector('input[name="choice"]:checked');
      if (!picked) {
        document.getElementById("feedback").innerHTML = `<div class="result">Alege un răspuns înainte să trimiți.</div>`;
        return;
      }
      revealAnswer(Number(picked.value), false);
    };

    document.getElementById("skipBtn").onclick = () => {
      if (locked) return;
      revealAnswer(null, false);
    };

    if (hasLink) setInfiniteTimerUI();
    else startTimer(DEFAULT_TIME_PER_Q);
  }

  function revealAnswer(selectedIndex, timedOut){
    locked = true;
    stopTimer();

    const q = questions[idx];
    const correct = q.answerIndex;
    const isCorrect = (selectedIndex === correct);

    if (isCorrect) score += 1;

    const pickedText = (selectedIndex === null)
      ? (timedOut ? "⏰ Timpul a expirat." : "Ai sărit întrebarea.")
      : `Ai ales: <b>${q.choices[selectedIndex]}</b>`;

    const status = isCorrect ? "✅ Corect" : "❌ Greșit";
    const boxClass = isCorrect ? "result ok" : "result bad";

    document.getElementById("feedback").innerHTML = `
      <div class="${boxClass}">
        <div style="font-size:16px; margin-bottom:6px;"><b>${status}</b></div>
        <div>${pickedText}</div>
        <div style="margin-top:8px;">
          Răspuns corect: <b>${q.choices[correct]}</b>
        </div>
        <div style="margin-top:8px; opacity:.9">
          Explicație: ${q.explanation ?? "(fără explicație)"}
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button class="primary" id="nextBtn">${idx < questions.length - 1 ? "Următoarea întrebare" : "Vezi rezultatul final"}</button>
      </div>
    `;

    document.getElementById("scoreNow").textContent = score;

    document.getElementById("nextBtn").onclick = () => {
      idx += 1;
      if (idx < questions.length) renderQuestion();
      else renderFinal();
    };
  }

  function renderFinal(){
    stopTimer();
    qCounter.textContent = "Final";
    timerBadge.innerHTML = `⏳ Timp: <span id="timeLeft">—</span>`;
    progressWrap.style.display = "none";

    const total = questions.length;
    const nota = grade1to10(score, total);

    app.innerHTML = `
      <h2>Rezultat final</h2>
      <div class="result ok">
        <div>Răspunsuri corecte: <b>${score}</b> / <b>${total}</b></div>
        <div style="margin-top:8px;">Notă: <b>${nota}</b> / 10</div>
      </div>
      <div class="row" style="margin-top:12px;">
        <button class="primary" id="restartBtn">Reîncepe quiz-ul</button>
      </div>
      <p class="small muted" style="margin-top:10px;">
        Notarea este proporțională: 0% = 1, 100% = 10.
      </p>
    `;

    document.getElementById("restartBtn").onclick = () => {
      idx = 0;
      score = 0;
      renderQuestion();
    };
  }

  renderQuestion();
</script>

</body>
</html>
