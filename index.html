<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Limba Română</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; max-width: 980px; margin: 24px auto; padding: 0 16px; }
    .topbar { display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
    .badge { display:inline-block; padding:6px 10px; border:1px solid #ddd; border-radius:999px; font-size:14px; }
    .card { border:1px solid #e5e5e5; border-radius:14px; padding:16px; margin:14px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.04); }
    h1 { margin: 0 0 10px; font-size: 22px; }
    h2 { margin: 0 0 10px; font-size: 18px; line-height: 1.35; }
    .choices { margin: 10px 0; }
    .choice { display:flex; gap:10px; padding:10px; border:1px solid #eee; border-radius:12px; margin:8px 0; cursor:pointer; }
    .choice:hover { background: #fafafa; }
    .choice input { margin-top: 3px; }
    button { padding:10px 14px; border-radius:12px; border:1px solid #ddd; background:white; cursor:pointer; font-weight:600; }
    button:hover { background:#f6f6f6; }
    button.primary { background:#111; color:#fff; border-color:#111; }
    button.primary:hover { background:#222; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    .muted { opacity:.75; }
    .result { padding: 12px; border-radius: 12px; border: 1px solid #e9e9e9; background: #fbfbfb; margin-top: 12px; }
    .ok { border-color: #cfead6; background: #f3fbf5; }
    .bad { border-color: #ffd0d0; background: #fff5f5; }
    .timer { font-variant-numeric: tabular-nums; }
    .progress { height: 10px; background: #eee; border-radius: 999px; overflow:hidden; margin-top: 10px; }
    .progress > div { height:100%; width:0%; background:#111; transition: width .2s linear; }
    .footer { margin-top: 18px; display:flex; justify-content:space-between; gap: 12px; flex-wrap:wrap; }
    .small { font-size: 13px; }
    code { background:#f6f6f6; padding:2px 6px; border-radius:8px; }

    /* Cerință: cuvintele între ** ** -> bold + underline */
    .emph { font-weight: 700; text-decoration: underline; }

    /* Link-uri vizibile */
    a { color: #0b57d0; text-decoration: underline; }
    a:hover { opacity: .85; }
  </style>
</head>
<body>

<h1>Quiz Limba Română</h1>

<div class="topbar">
  <div class="badge" id="qCounter">Întrebarea 1 / 1</div>
  <div class="badge timer" id="timerBadge">⏳ Timp rămas: <span id="timeLeft">00:30</span></div>
</div>
<div class="progress" id="progressWrap"><div id="timeBar"></div></div>

<div id="app" class="card"></div>

<script>
  // === Întrebări (JSON-ul tău) ===
  const questions = [
    {
      "question": "În enunțul „A munci nu este ușor” [Sursa 1], verbul la infinitiv „A munci” are funcția sintactică de:",
      "choices": ["Predicat verbal", "Subiect", "Complement direct", "Atribut verbal"],
      "answerIndex": 1,
      "explanation": "Verbul la infinitiv răspunde la întrebarea „ce nu este ușor?” (faptul de a munci), îndeplinind funcția de subiect."
    },
    {
      "question": "Conform regulilor fonetice din surse, în cuvântul „cheamă” [Sursa 127], grupul de litere „che” notează:",
      "choices": ["Două sunete [k] și [e]", "Un singur sunet [k’] (consoană)", "Trei sunete", "Niciun sunet"],
      "answerIndex": 1,
      "explanation": "Deoarece grupul „che” este urmat de vocala „a” în aceeași silabă, „e” este doar literă ajutătoare, grupul notând sunetul [k’]."
    },
    {
      "question": "Forma corectă de Genitiv-Dativ a substantivului „minge” este: [Sursa 31]",
      "choices": ["Mingei", "Mingii", "Mingiei", "Mingii-le"],
      "answerIndex": 1,
      "explanation": "Conform tabelului de forme corecte/incorecte, forma articulată de genitiv-dativ pentru „minge” este „mingii” (nu „mingei”)."
    },
    {
      "question": "Termenul argotic „bișniță” provine din limba: [Sursa 145]",
      "choices": ["Franceză", "Engleză", "Germană", "Turcă"],
      "answerIndex": 1,
      "explanation": "Este un împrumut adaptat din limba engleză (din cuvântul „business”)."
    },
    {
      "question": "Anafora este definită în surse ca: [Sursa 103]",
      "choices": ["O repetiție supărătoare a unui sunet", "Reluarea unui cuvânt (antecedent) printr-un alt cuvânt (anaforic)", "O figură de stil de exagerare", "Un tip de rimă"],
      "answerIndex": 1,
      "explanation": "Anafora asigură coerența textului prin reluarea informației (ex: Ana scrie. *Ea* este talentată), unde „ea” este anaforicul."
    },
    {
      "question": "Valoarea culturală asociată cu romanul „Mesagerul” de Lois Lowry în tabelul de asociere este: [Sursa 34]",
      "choices": ["Prietenia și aventura", "Generozitate, bunătate", "Relația om-animal", "Educația"],
      "answerIndex": 1,
      "explanation": "Tabelul grupează „Mesagerul” alături de „Legenda lui Filemon și Baucis” la categoria valori: generozitate și bunătate."
    },
    {
      "question": "În fraza „Am impresia că tu minți mereu” [Sursa 87], propoziția subordonată este:",
      "choices": ["Completivă directă", "Subiectivă", "Atributivă", "Completivă indirectă"],
      "answerIndex": 2,
      "explanation": "Propoziția determină substantivul „impresia” (care impresie? -> impresia *că tu minți*), fiind o subordonată atributivă."
    },
    {
      "question": "Conform regulilor de punctuație a conjuncției „deci”: [Sursa 186]",
      "choices": ["Se pune virgulă întotdeauna înainte și după", "Când este în interiorul propoziției, NU se izolează prin virgulă", "Nu se pune niciodată virgulă înainte", "Cere punct și virgulă"],
      "answerIndex": 1,
      "explanation": "Dacă „deci” apare în interiorul propoziției (ex: „A învățat, știe deci bine”), nu se pune virgulă. Se pune virgulă doar dacă coordonează propoziții."
    },
    {
      "question": "În enunțul „Directorul le-a transmis părinților programul” [Sursa 89], substantivul „părinților” este în cazul:",
      "choices": ["Genitiv", "Acuzativ", "Dativ", "Nominativ"],
      "answerIndex": 2,
      "explanation": "Răspunde la întrebarea „cui a transmis?” -> părinților. Este complement indirect în cazul Dativ."
    },
    {
      "question": "Pronumele de politețe „dumneavoastră” se acordă cu verbul la: [Sursa 92]",
      "choices": ["Persoana a II-a singular", "Persoana a II-a plural", "Persoana a III-a plural", "Persoana I plural"],
      "answerIndex": 1,
      "explanation": "Chiar dacă se referă la o singură persoană, pronumele „dumneavoastră” cere verbul la persoana a II-a plural (Voi mergeți / Dumneavoastră mergeți)."
    },
    {
      "question": "În versurile „Credința-i val, iubirea vânt”, figura de stil este: [Sursa 131]",
      "choices": ["Comparație", "Metaforă", "Epitet", "Personificare"],
      "answerIndex": 1,
      "explanation": "Este o metaforă (definiție implicită), deoarece lipsește termenul de comparare „ca”, realizându-se o identificare directă."
    },
    {
      "question": "Cuvântul „harnicul” din enunțul „Harnicul este mulțumit” este: [Sursa 202]",
      "choices": ["Adjectiv", "Substantiv", "Adverb", "Pronume"],
      "answerIndex": 1,
      "explanation": "Prin articulare cu articolul hotărât „-l”, adjectivul „harnic” a devenit substantiv (conversiune)."
    },
    {
      "question": "Care este forma corectă de Genitiv-Dativ plural a substantivului „ou”? [Sursa 31]",
      "choices": ["Ouălelor", "Ouălor", "Oualelor", "Oilor"],
      "answerIndex": 1,
      "explanation": "Conform normelor, forma corectă este „ouălor” (nu „ouălelor”)."
    },
    {
      "question": "În sintagma „lacul înghețat”, epitetul este exprimat prin: [Sursa 131]",
      "choices": ["Adjectiv propriu-zis", "Verb la participiu", "Adverb", "Substantiv"],
      "answerIndex": 1,
      "explanation": "Cuvântul „înghețat” provine din verbul „a îngheța” la participiu, devenit adjectiv."
    },
    {
      "question": "Conform testului de ortografie, varianta corectă este: [Sursa 15]",
      "choices": ["Hainele trebuiesc aranjate", "Hainele trebuie aranjate"],
      "answerIndex": 1,
      "explanation": "Verbul „a trebui” este impersonal și unipersonal în limba literară, deci forma corectă este „trebuie” (indiferent de numărul obiectelor)."
    },
    {
      "question": "Verbul auxiliar „a fi” NU are forme pentru modul: [Sursa 152]",
      "choices": ["Indicativ", "Conjunctiv", "Imperativ", "Condițional-optativ"],
      "answerIndex": 2,
      "explanation": "Ca auxiliar (folositor la formarea timpurilor compuse), „a fi” nu are forme de Imperativ."
    },
    {
      "question": "Prepoziția „împrejurul” cere cazul: [Sursa 41]",
      "choices": ["Acuzativ", "Dativ", "Genitiv", "Nominativ"],
      "answerIndex": 2,
      "explanation": "Prepozițiile „împrejurul”, „deasupra”, „dedesubtul”, „contra” cer obligatoriu cazul Genitiv (împrejurul casei)."
    },
    {
      "question": "În enunțul „Filmul este de văzut” [Sursa 4], structura „de văzut” este:",
      "choices": ["Verb la infinitiv", "Verb la supin (Nume Predicativ)", "Verb la participiu", "Adverb"],
      "answerIndex": 1,
      "explanation": "Verbul la supin (prepoziție + participiu) formează împreună cu verbul copulativ „este” un predicat nominal."
    },
    {
      "question": "În cuvântul „tigroaică”, grupul „oai” este un: [Sursa 47]",
      "choices": ["Diftong", "Triftong", "Hiat", "Nu formează grup vocalic"],
      "answerIndex": 1,
      "explanation": "Conține o vocală (a) și două semivocale (o, i) în aceeași silabă, fiind un triftong."
    },
    {
      "question": "Indicațiile scenice scrise înaintea textului dialogat (lista personajelor) sunt: [Sursa 195]",
      "choices": ["Indicații interne", "Indicații externe", "Replici", "Monologuri"],
      "answerIndex": 1,
      "explanation": "Fiind plasate la început, în afara dialogului propriu-zis, se numesc indicații externe (sau inițiale)."
    },
    {
      "question": "În propoziția „Păsările zboară” [Sursa 37], predicatul este:",
      "choices": ["Verbal", "Nominal", "Adverbial", "Interjecțional"],
      "answerIndex": 0,
      "explanation": "Verbul „zboară” are înțeles de sine stătător și arată o acțiune, fiind predicat verbal."
    },
    {
      "question": "În registru solemn, pronunția este caracterizată prin: [Sursa 141]",
      "choices": ["Căderi de sunete", "Pronunțare neglijentă", "Pronunțare foarte îngrijită și clară", "Folosirea diminutivelor"],
      "answerIndex": 2,
      "explanation": "Registrul solemn impune respectarea strictă a normelor și o dicție clară (ex: pronunțarea finală a lui -l din articol)."
    },
    {
      "question": "Locuțiunile conjuncționale „numai că”, „doar că” au valoare: [Sursa 187]",
      "choices": ["Copulativă", "Adversativă", "Concluzivă", "Disjunctivă"],
      "answerIndex": 1,
      "explanation": "Acestea introduc o opoziție sau o restricție, echivalând cu „dar” sau „însă”."
    },
    {
      "question": "Măsura versurilor de 5-6 silabe este considerată: [Sursa 192]",
      "choices": ["Scurtă", "Medie", "Lungă", "Foarte lungă"],
      "answerIndex": 0,
      "explanation": "Versurile cu un număr mic de silabe (5-6) sunt încadrate la măsura scurtă."
    },
    {
      "question": "Interjecția compusă din exemplele de mai jos este: [Sursa 133]",
      "choices": ["Au", "Miau", "Hodoronc-tronc", "Vaaai"],
      "answerIndex": 2,
      "explanation": "Este formată din două elemente sonore diferite, fiind o interjecție compusă."
    }
  ];

  const app = document.getElementById("app");
  const qCounter = document.getElementById("qCounter");
  const timeBar = document.getElementById("timeBar");
  const timerBadge = document.getElementById("timerBadge");
  const progressWrap = document.getElementById("progressWrap");

  // === CERINȚE QUIZ LIMBA ROMÂNĂ (din conversația anterioară) ===
  // - 30 secunde / întrebare
  // - excepție: întrebările care AU link (în paranteze "Link text: https://...") -> timp infinit
  const DEFAULT_TIME_PER_Q = 30; // sec
  const INFINITE = null;

  let idx = 0;
  let score = 0;
  let timer = null;
  let remaining = DEFAULT_TIME_PER_Q;
  let locked = false;

  function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

  function grade1to10(correct, total) {
    if (total <= 0) return 1;
    const ratio = correct / total;
    const g = 1 + ratio * 9; // 0% -> 1, 100% -> 10
    return Math.round(g * 100) / 100;
  }

  function stopTimer(){
    if (timer) { clearInterval(timer); timer = null; }
  }

  function escapeHtml(s){
    return String(s)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }

  // Cerințe formatare păstrate:
  // - **...** => bold + underline
  // - Link-urile din (Link text: https://...) -> clickable + spațiu înainte de ")"
  function formatText(raw) {
    let text = escapeHtml(raw);

    // (Link text: URL) => (Link text: <a href="URL">URL</a> )
    text = text.replace(/\(Link text:\s*(https?:\/\/[^\s)]+)\s*\)/g, (m, url) => {
      return `(Link text: <a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a> )`;
    });

    // **...** => bold + underline
    text = text.replace(/\*\*(.+?)\*\*/g, '<span class="emph">$1</span>');

    return text;
  }

  function hasReferenceLink(questionText) {
    return /(Link text:)/i.test(questionText) || /(https?:\/\/)/i.test(questionText);
  }

  function fmtTime(seconds){
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    return String(m).padStart(2,"0") + ":" + String(s).padStart(2,"0");
  }

  function startTimer(secondsOrNull){
    stopTimer();

    if (secondsOrNull === INFINITE) {
      progressWrap.style.display = "none";
      timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">∞</span>`;
      return;
    }

    const seconds = secondsOrNull;
    remaining = seconds;
    progressWrap.style.display = "block";
    timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">${fmtTime(remaining)}</span>`;
    timeBar.style.width = "100%";

    timer = setInterval(() => {
      remaining -= 1;
      const tl = document.getElementById("timeLeft");
      if (tl) tl.textContent = fmtTime(Math.max(remaining, 0));

      const pct = (remaining / seconds) * 100;
      timeBar.style.width = clamp(pct, 0, 100) + "%";

      if (remaining <= 0) {
        stopTimer();
        revealAnswer(null, true);
      }
    }, 1000);
  }

  function renderQuestion(){
    locked = false;
    const q = questions[idx];
    qCounter.textContent = `Întrebarea ${idx + 1} / ${questions.length}`;

    const timeForThis = hasReferenceLink(q.question) ? INFINITE : DEFAULT_TIME_PER_Q;

    app.innerHTML = `
      <h2>${formatText(q.question)}</h2>
      <div class="choices">
        ${q.choices.map((c, i) => `
          <label class="choice">
            <input type="radio" name="choice" value="${i}">
            <span>${formatText(c)}</span>
          </label>
        `).join("")}
      </div>
      <div class="row">
        <button class="primary" id="submitBtn">Trimite răspuns</button>
        <button id="skipBtn">Nu știu / sari</button>
      </div>
      <div id="feedback"></div>
      <div class="footer small muted">
        <div>Scor curent: <b id="scoreNow">${score}</b> / ${questions.length}</div>
        <div>Timp / întrebare: <code>${timeForThis === INFINITE ? "∞" : fmtTime(timeForThis)}</code></div>
      </div>
    `;

    document.getElementById("submitBtn").onclick = () => {
      if (locked) return;
      const picked = app.querySelector('input[name="choice"]:checked');
      if (!picked) {
        document.getElementById("feedback").innerHTML = `<div class="result">Alege un răspuns înainte să trimiți.</div>`;
        return;
      }
      revealAnswer(Number(picked.value), false);
    };

    document.getElementById("skipBtn").onclick = () => {
      if (locked) return;
      revealAnswer(null, false);
    };

    startTimer(timeForThis);
  }

  function revealAnswer(selectedIndex, timedOut){
    locked = true;
    stopTimer();

    const q = questions[idx];
    const correct = q.answerIndex;
    const isCorrect = (selectedIndex === correct);

    if (isCorrect) score += 1;

    const pickedText = (selectedIndex === null)
      ? (timedOut ? "⏰ Timpul a expirat." : "Ai sărit întrebarea.")
      : `Ai ales: <b>${formatText(q.choices[selectedIndex])}</b>`;

    const status = isCorrect ? "✅ Corect" : "❌ Greșit";
    const boxClass = isCorrect ? "result ok" : "result bad";

    document.getElementById("feedback").innerHTML = `
      <div class="${boxClass}">
        <div style="font-size:16px; margin-bottom:6px;"><b>${status}</b></div>
        <div>${pickedText}</div>
        <div style="margin-top:8px;">
          Răspuns corect: <b>${formatText(q.choices[correct])}</b>
        </div>
        <div style="margin-top:8px; opacity:.9">
          Explicație: ${formatText(q.explanation || "(fără explicație)")}
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button class="primary" id="nextBtn">${idx < questions.length - 1 ? "Următoarea întrebare" : "Vezi rezultatul final"}</button>
      </div>
    `;

    const scoreNow = document.getElementById("scoreNow");
    if (scoreNow) scoreNow.textContent = score;

    document.getElementById("nextBtn").onclick = () => {
      idx += 1;
      if (idx < questions.length) renderQuestion();
      else renderFinal();
    };
  }

  function renderFinal(){
    stopTimer();
    qCounter.textContent = "Final";
    timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">—</span>`;
    progressWrap.style.display = "none";

    const total = questions.length;
    const nota = grade1to10(score, total);

    app.innerHTML = `
      <h2>Rezultat final</h2>
      <div class="result ok">
        <div>Răspunsuri corecte: <b>${score}</b> / <b>${total}</b></div>
        <div style="margin-top:8px;">Notă: <b>${nota}</b> / 10</div>
      </div>
      <div class="row" style="margin-top:12px;">
        <button class="primary" id="restartBtn">Reîncepe quiz-ul</button>
      </div>
      <p class="small muted" style="margin-top:10px;">
        Notarea este proporțională: 0% = 1, 100% = 10.
      </p>
    `;

    document.getElementById("restartBtn").onclick = () => {
      idx = 0;
      score = 0;
      renderQuestion();
    };
  }

  renderQuestion();
</script>

</body>
</html>
