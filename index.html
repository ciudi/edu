<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Limba Română</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; max-width: 980px; margin: 24px auto; padding: 0 16px; }
    .topbar { display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
    .badge { display:inline-block; padding:6px 10px; border:1px solid #ddd; border-radius:999px; font-size:14px; }
    .card { border:1px solid #e5e5e5; border-radius:14px; padding:16px; margin:14px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.04); }
    h1 { margin: 0 0 10px; font-size: 22px; }
    h2 { margin: 0 0 10px; font-size: 18px; line-height: 1.35; }
    .choices { margin: 10px 0; }
    .choice { display:flex; gap:10px; padding:10px; border:1px solid #eee; border-radius:12px; margin:8px 0; cursor:pointer; }
    .choice:hover { background: #fafafa; }
    .choice input { margin-top: 3px; }
    button { padding:10px 14px; border-radius:12px; border:1px solid #ddd; background:white; cursor:pointer; font-weight:600; }
    button:hover { background:#f6f6f6; }
    button.primary { background:#111; color:#fff; border-color:#111; }
    button.primary:hover { background:#222; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    .muted { opacity:.75; }
    .result { padding: 12px; border-radius: 12px; border: 1px solid #e9e9e9; background: #fbfbfb; margin-top: 12px; }
    .ok { border-color: #cfead6; background: #f3fbf5; }
    .bad { border-color: #ffd0d0; background: #fff5f5; }
    .timer { font-variant-numeric: tabular-nums; }
    .progress { height: 10px; background: #eee; border-radius: 999px; overflow:hidden; margin-top: 10px; }
    .progress > div { height:100%; width:0%; background:#111; transition: width .2s linear; }
    .footer { margin-top: 18px; display:flex; justify-content:space-between; gap: 12px; flex-wrap:wrap; }
    .small { font-size: 13px; }
    code { background:#f6f6f6; padding:2px 6px; border-radius:8px; }

    /* Cerință: cuvintele între ** ** -> bold + underline */
    .emph { font-weight: 700; text-decoration: underline; }

    a { color: #0b57d0; text-decoration: underline; }
    a:hover { opacity: .85; }
  </style>
</head>
<body>

<h1>Quiz Limba Română</h1>

<div class="topbar">
  <div class="badge" id="qCounter">Întrebarea 1 / 1</div>
  <div class="badge timer" id="timerBadge">⏳ Timp rămas: <span id="timeLeft">00:30</span></div>
</div>
<div class="progress" id="progressWrap"><div id="timeBar"></div></div>

<div id="app" class="card"></div>

<script>
  // === Întrebări (JSON-ul tău) ===
  const questions = [
    {
      "question": "Funcția sintactică a structurii evidențiate în propoziția: „Am resimțit emoțiile **de atunci**” este: [Sursa 99]",
      "choices": ["Complement circumstanțial de timp", "Atribut", "Nume predicativ", "Complement prepozițional"],
      "answerIndex": 1,
      "explanation": "Când un adverb determină un substantiv („emoțiile”) și se leagă de acesta printr-o prepoziție, îndeplinește funcția de atribut (realizat prin adverb)."
    },
    {
      "question": "Conform testului de ortografie, alege varianta corect scrisă: [Sursa 15]",
      "choices": ["Paremi-se că ai fost pe aici.", "Pare-mi-se că ai fost pe aici.", "Pare-mi se că ai fost pe aici.", "Pare mi-se că ai fost pe aici."],
      "answerIndex": 1,
      "explanation": "Structura este alcătuită din verbul „pare”, pronumele „mi” și pronumele „se”, toate despărțite prin cratimă: „pare-mi-se”."
    },
    {
      "question": "În enunțul „Oamenii aceștia **suferinzi** mă întristează” [Sursa 1], cuvântul evidențiat are valoarea morfologică de:",
      "choices": ["Verb la gerunziu", "Substantiv", "Adjectiv provenit din gerunziu", "Adverb de mod"],
      "answerIndex": 2,
      "explanation": "Deoarece se acordă în gen, număr și caz cu substantivul „oamenii” (primind și desinența de plural -i), gerunziul a devenit adjectiv."
    },
    {
      "question": "În textul dramatic, monologul are rolul de a: [Sursa 197]",
      "choices": ["Oferi instrucțiuni regizorului pentru decor", "Provoca râsul publicului prin înfățișare", "Ajuta la înțelegerea gândurilor și intențiilor personajului", "Înlocui didascaliile externe"],
      "answerIndex": 2,
      "explanation": "Monologul este o intervenție amplă care dezvăluie stările interioare, gândurile și intențiile unui personaj, rostit în prezența sau absența altora."
    },
    {
      "question": "Condiția obligatorie pentru ca o propoziție activă să poată fi transformată în propoziție pasivă este ca aceasta să aibă: [Sursa 116]",
      "choices": ["Un complement circumstanțial de mod", "Un verb copulativ", "Un complement direct", "Un subiect neexprimat"],
      "answerIndex": 2,
      "explanation": "Transformarea este posibilă doar dacă acțiunea cade direct asupra unui obiect (complement direct), care în diateza pasivă va deveni subiect gramatical."
    },
    {
      "question": "Valoarea culturală asociată cu romanul „Fahrenheit 451” de Ray Bradbury în tabelul de valori este: [Sursa 82]",
      "choices": ["Respectul față de animale", "Pasiunea pentru cărți / importanța lecturii", "Dorința de libertate", "Curajul în fața morții"],
      "answerIndex": 1,
      "explanation": "Fișa de sinteză asociază opera lui Bradbury cu importanța lecturii și pasiunea pentru cărți."
    },
    {
      "question": "Alege varianta corectă de folosire a semiadverbului „mai” alături de un pronume clitic: [Sursa 100]",
      "choices": ["Mai îmi dai o carte?", "Îmi dai mai o carte?", "Îmi mai dai o carte?", "Mai dai îmi o carte?"],
      "answerIndex": 2,
      "explanation": "Norma limbii literare impune utilizarea lui „mai” între forma clitică a pronumelui și verb: „Îmi mai dai...” (nu „Mai îmi dai...”)."
    },
    {
      "question": "Poezia „Lecția de citire” de Nichita Stănescu este caracterizată prin: [Sursa 188]",
      "choices": ["Respectarea strictă a normelor versificației clasice", "Renunțarea la regulile tradiționale de prozodie", "Redarea frumuseții naturii specifice romantismului", "Lipsa totală a figurilor de stil"],
      "answerIndex": 1,
      "explanation": "Aparținând poeziei secolului XX (neosimbolism/modernism târziu), ea se remarcă prin originalitate, limbaj neobișnuit și renunțarea la prozodia clasică."
    },
    {
      "question": "În sintagma englezească împrumutată „hobby-ul”, cratima este folosită deoarece: [Sursa 130]",
      "choices": ["Marchează o pauză în rostire", "Finala cuvântului se pronunță diferit față de cum se scrie", "Leagă două substantive", "Așa se scrie în limba de origine"],
      "answerIndex": 1,
      "explanation": "La împrumuturile neadaptate, dacă litera finală nu se pronunță ca în română (aici y se pronunță [i]), articolul hotărât se atașează prin cratimă."
    },
    {
      "question": "„Regula noncontradicției” pentru coerența unui text presupune ca: [Sursa 103]",
      "choices": ["Fiecare enunț să aducă o informație nouă", "Să existe multe conjuncții adversative", "Enunțurile să nu se contrazică și să nu schimbe nejustificat persoana sau timpul", "Să nu se repete niciun cuvânt"],
      "answerIndex": 2,
      "explanation": "Coerența logică (noncontradicția) se pierde dacă afirmațiile se anulează reciproc sau dacă perspectiva narativă/timpul sare haotic."
    },
    {
      "question": "Alege forma corectă de Genitiv-Dativ a substantivului „varză”: [Sursa 31]",
      "choices": ["Varzei", "Verzii", "Verzei", "Vărzii"],
      "answerIndex": 2,
      "explanation": "Conform tabelului de forme corecte/incorecte, singularul articulat de G-D este „verzei” (nu „varzei” și nu „verzii”)."
    },
    {
      "question": "Ce funcție sintactică are structura evidențiată în propoziția: „Plăcerea **de a dansa** a păstrat-o pentru sine”? [Sursa 1]",
      "choices": ["Complement direct", "Atribut verbal", "Subiect", "Nume predicativ"],
      "answerIndex": 1,
      "explanation": "Modul infinitiv însoțit de prepoziția „de” determină substantivul „plăcerea” (care plăcere?), îndeplinind funcția de atribut verbal."
    },
    {
      "question": "În propoziția „Timpul este focul în care ne ardem existența”, transformarea cuvântului evidențiat dintr-o metaforă într-o expresie propriu-zisă se bazează pe: [Sursa 149]",
      "choices": ["O personificare detaliată", "O aliterație", "O comparație din care a fost eliminat cuvântul de legătură (ca, precum)", "O hiperbolă"],
      "answerIndex": 2,
      "explanation": "Metafora este explicată teoretic ca fiind o comparație subînțeleasă din care s-a eliminat termenul comparat sau prepoziția comparativă."
    },
    {
      "question": "Alegeți seria care conține doar cuvinte scrise corect: [Sursa 57]",
      "choices": ["păianjen, monezi, înpărat", "ecleruri, macheaj, glesnă", "tăiței, zori, poiane", "agheasmă, foitaj, adolescență, tangou"],
      "answerIndex": 3,
      "explanation": "Formele corecte sunt „agheasmă” (nu aghiasmă), „foitaj” (nu foietaj), „adolescență”, „tangou”. În celelalte serii există greșeli (ex: monezi -> monede, macheaj -> machiaj)."
    },
    {
      "question": "În propoziția „**Uite** că ai sosit!”, cuvântul „uite” este: [Sursa 87]",
      "choices": ["Verb la imperativ", "Interjecție predicativă", "Adverb de mod", "Conjuncție"],
      "answerIndex": 1,
      "explanation": "Deși exprimă un îndemn/atenționare, „uite” este o interjecție care, regând o subordonată completivă directă, are funcție de predicat verbal."
    },
    {
      "question": "Construcțiile incidente dintr-un text au rolul de a: [Sursa 112]",
      "choices": ["Dezvolta subiectul principal", "Reproduce vorbirea (fenomen de oralitate)", "Aduce informații esențiale pentru înțelegerea frazei", "Anula acțiunea verbului"],
      "answerIndex": 1,
      "explanation": "Ele reprezintă o comunicare suplimentară, inserată în text, specifică oralității populare sau culte, servind adesea la reproducerea vorbirii directe."
    },
    {
      "question": "Formarea termenului argotic „bac” (din bacalaureat) s-a realizat prin: [Sursa 145]",
      "choices": ["Derivare", "Compunere", "Împrumut", "Trunchiere"],
      "answerIndex": 3,
      "explanation": "Trunchierea este procesul de scurtare a unui cuvânt prin eliminarea părții finale, frecvent întâlnit în limbajul argotic și familiar."
    },
    {
      "question": "În versurile „Ce **a**lb, ce negru de **a**lb /... / și ne sufl**ă** și smulge...” repetiția vocalei „a/ă” poate fi considerată o: [Sursa 148]",
      "choices": ["Aliterație", "Asonanță (repetarea vocalelor accentuate)", "Metaforă implicită", "Hiperbolă"],
      "answerIndex": 1,
      "explanation": "Dacă aliterația este repetarea consoanelor, repetarea vocalelor pentru un efect sonor/muzical este definită ca asonanță în tabelul cu figuri de stil."
    },
    {
      "question": "În enunțul „Îmi trebuie un caiet nou” [Sursa 109], subiectul este:",
      "choices": ["Eu (inclus)", "Mie (subînțeles)", "Un caiet", "Nu există subiect"],
      "answerIndex": 2,
      "explanation": "Verbul „a trebui” este impersonal. Întrebarea pentru subiect este „ce îmi trebuie?”, răspunsul fiind „un caiet” (subiect nonuman)."
    },
    {
      "question": "Conform regulilor de punctuație [Sursa 135], dacă o interjecție este urmată imediat de un substantiv în Vocativ (ex. *Măi Radu*), virgula se pune:",
      "choices": ["Între interjecție și substantiv", "După întregul grup (interjecție + substantiv)", "Nu se pune deloc virgulă", "Doar la sfârșitul propoziției"],
      "answerIndex": 1,
      "explanation": "Grupul format din interjecția de adresare și substantivul în vocativ nu se desparte prin virgulă în interiorul său, ci se izolează împreună de restul enunțului."
    },
    {
      "question": "În propoziția „Fratele tău a făcut un **bine**”, cuvântul evidențiat este: [Sursa 121]",
      "choices": ["Adverb de mod", "Adjectiv", "Substantiv (format prin conversiune)", "Verb la infinitiv"],
      "answerIndex": 2,
      "explanation": "Adverbul „bine” a fost articulat cu articolul nehotărât „un”, trecând astfel în clasa substantivelor (conversiune)."
    },
    {
      "question": "Identifică forma corectă de Genitiv-Dativ a substantivului „cămașă”: [Sursa 31]",
      "choices": ["Cămășei", "Cămășii", "Cămașei", "Cămășelor"],
      "answerIndex": 1,
      "explanation": "Pluralul este „cămăși”, iar forma articulată de genitiv-dativ singular se formează plecând de la această bază, adăugând „-i”: „cămășii”."
    },
    {
      "question": "Care este valoarea verbelor subliniate în: „Aș **fi** pregătit cina, dar **eram** obosită.”? [Sursa 49]",
      "choices": ["Verb auxiliar, verb copulativ", "Verb predicativ, verb predicativ", "Verb auxiliar, verb auxiliar", "Verb copulativ, verb auxiliar"],
      "answerIndex": 0,
      "explanation": "„Fi” ajută la formarea condițional-optativului perfect (auxiliar), iar „eram” face legătura cu numele predicativ „obosită” (copulativ)."
    },
    {
      "question": "Cuvintele „chiorâș” și „târâș” sunt adverbe formate prin: [Sursa 96]",
      "choices": ["Compunere prin alăturare", "Conversiune din adjective", "Derivare cu sufixul -âș", "Împrumut din maghiară"],
      "answerIndex": 2,
      "explanation": "Fișa de studiu menționează explicit că unele adverbe se formează prin derivare, adăugând sufixe precum -ește, -iș sau -âș la rădăcina cuvântului de bază."
    },
    {
      "question": "În limba română, sunetul [k] poate fi redat ortografic prin literele: [Sursa 126]",
      "choices": ["Doar prin c", "Prin c, q și k", "Prin c, g și h", "Doar prin k"],
      "answerIndex": 1,
      "explanation": "Fișa de fonetică menționează că există excepții unde un sunet este redat prin mai multe litere, dând exemplul sunetului [k] redat de c (cap), q (quasar) sau k (kilogram)."
    }
  ];

  const app = document.getElementById("app");
  const qCounter = document.getElementById("qCounter");
  const timeBar = document.getElementById("timeBar");
  const timerBadge = document.getElementById("timerBadge");
  const progressWrap = document.getElementById("progressWrap");

  // === CERINȚE QUIZ LIMBA ROMÂNĂ ===
  // - 30 secunde / întrebare
  // - excepție: întrebările care AU link (în paranteze "Link text: https://...") -> timp infinit
  // (În acest set NU există "Link text:", dar păstrăm regula.)
  const DEFAULT_TIME_PER_Q = 30; // sec
  const INFINITE = null;

  let idx = 0;
  let score = 0;
  let timer = null;
  let remaining = DEFAULT_TIME_PER_Q;
  let locked = false;

  function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

  function grade1to10(correct, total) {
    if (total <= 0) return 1;
    const ratio = correct / total;
    const g = 1 + ratio * 9; // 0% -> 1, 100% -> 10
    return Math.round(g * 100) / 100;
  }

  function stopTimer(){
    if (timer) { clearInterval(timer); timer = null; }
  }

  function escapeHtml(s){
    return String(s)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }

  // Cerințe formatare:
  // - **...** => bold + underline
  // - Link-urile din (Link text: https://...) -> clickable + spațiu înainte de ")"
  function formatText(raw) {
    let text = escapeHtml(raw);

    text = text.replace(/\(Link text:\s*(https?:\/\/[^\s)]+)\s*\)/g, (m, url) => {
      return `(Link text: <a href="${url}" target="_blank" rel="noopener noreferrer">${url}</a> )`;
    });

    text = text.replace(/\*\*(.+?)\*\*/g, '<span class="emph">$1</span>');

    return text;
  }

  function hasReferenceLink(questionText) {
    return /(Link text:)/i.test(questionText) || /(https?:\/\/)/i.test(questionText);
  }

  function fmtTime(seconds){
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    return String(m).padStart(2,"0") + ":" + String(s).padStart(2,"0");
  }

  function startTimer(secondsOrNull){
    stopTimer();

    if (secondsOrNull === INFINITE) {
      progressWrap.style.display = "none";
      timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">∞</span>`;
      return;
    }

    const seconds = secondsOrNull;
    remaining = seconds;
    progressWrap.style.display = "block";
    timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">${fmtTime(remaining)}</span>`;
    timeBar.style.width = "100%";

    timer = setInterval(() => {
      remaining -= 1;
      const tl = document.getElementById("timeLeft");
      if (tl) tl.textContent = fmtTime(Math.max(remaining, 0));

      const pct = (remaining / seconds) * 100;
      timeBar.style.width = clamp(pct, 0, 100) + "%";

      if (remaining <= 0) {
        stopTimer();
        revealAnswer(null, true);
      }
    }, 1000);
  }

  function renderQuestion(){
    locked = false;
    const q = questions[idx];
    qCounter.textContent = `Întrebarea ${idx + 1} / ${questions.length}`;

    const timeForThis = hasReferenceLink(q.question) ? INFINITE : DEFAULT_TIME_PER_Q;

    app.innerHTML = `
      <h2>${formatText(q.question)}</h2>
      <div class="choices">
        ${q.choices.map((c, i) => `
          <label class="choice">
            <input type="radio" name="choice" value="${i}">
            <span>${formatText(c)}</span>
          </label>
        `).join("")}
      </div>
      <div class="row">
        <button class="primary" id="submitBtn">Trimite răspuns</button>
        <button id="skipBtn">Nu știu / sari</button>
      </div>
      <div id="feedback"></div>
      <div class="footer small muted">
        <div>Scor curent: <b id="scoreNow">${score}</b> / ${questions.length}</div>
        <div>Timp / întrebare: <code>${timeForThis === INFINITE ? "∞" : fmtTime(timeForThis)}</code></div>
      </div>
    `;

    document.getElementById("submitBtn").onclick = () => {
      if (locked) return;
      const picked = app.querySelector('input[name="choice"]:checked');
      if (!picked) {
        document.getElementById("feedback").innerHTML = `<div class="result">Alege un răspuns înainte să trimiți.</div>`;
        return;
      }
      revealAnswer(Number(picked.value), false);
    };

    document.getElementById("skipBtn").onclick = () => {
      if (locked) return;
      revealAnswer(null, false);
    };

    startTimer(timeForThis);
  }

  function revealAnswer(selectedIndex, timedOut){
    locked = true;
    stopTimer();

    const q = questions[idx];
    const correct = q.answerIndex;
    const isCorrect = (selectedIndex === correct);

    if (isCorrect) score += 1;

    const pickedText = (selectedIndex === null)
      ? (timedOut ? "⏰ Timpul a expirat." : "Ai sărit întrebarea.")
      : `Ai ales: <b>${formatText(q.choices[selectedIndex])}</b>`;

    const status = isCorrect ? "✅ Corect" : "❌ Greșit";
    const boxClass = isCorrect ? "result ok" : "result bad";

    document.getElementById("feedback").innerHTML = `
      <div class="${boxClass}">
        <div style="font-size:16px; margin-bottom:6px;"><b>${status}</b></div>
        <div>${pickedText}</div>
        <div style="margin-top:8px;">
          Răspuns corect: <b>${formatText(q.choices[correct])}</b>
        </div>
        <div style="margin-top:8px; opacity:.9">
          Explicație: ${formatText(q.explanation || "(fără explicație)")}
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button class="primary" id="nextBtn">${idx < questions.length - 1 ? "Următoarea întrebare" : "Vezi rezultatul final"}</button>
      </div>
    `;

    const scoreNow = document.getElementById("scoreNow");
    if (scoreNow) scoreNow.textContent = score;

    document.getElementById("nextBtn").onclick = () => {
      idx += 1;
      if (idx < questions.length) renderQuestion();
      else renderFinal();
    };
  }

  function renderFinal(){
    stopTimer();
    qCounter.textContent = "Final";
    timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">—</span>`;
    progressWrap.style.display = "none";

    const total = questions.length;
    const nota = grade1to10(score, total);

    app.innerHTML = `
      <h2>Rezultat final</h2>
      <div class="result ok">
        <div>Răspunsuri corecte: <b>${score}</b> / <b>${total}</b></div>
        <div style="margin-top:8px;">Notă: <b>${nota}</b> / 10</div>
      </div>
      <div class="row" style="margin-top:12px;">
        <button class="primary" id="restartBtn">Reîncepe quiz-ul</button>
      </div>
      <p class="small muted" style="margin-top:10px;">
        Notarea este proporțională: 0% = 1, 100% = 10.
      </p>
    `;

    document.getElementById("restartBtn").onclick = () => {
      idx = 0;
      score = 0;
      renderQuestion();
    };
  }

  renderQuestion();
</script>

</body>
</html>
