<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Matematică</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; max-width: 980px; margin: 24px auto; padding: 0 16px; }
    .topbar { display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap; }
    .badge { display:inline-block; padding:6px 10px; border:1px solid #ddd; border-radius:999px; font-size:14px; }
    .card { border:1px solid #e5e5e5; border-radius:14px; padding:16px; margin:14px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.04); }
    h1 { margin: 0 0 10px; font-size: 22px; }
    h2 { margin: 0 0 10px; font-size: 18px; line-height: 1.35; }
    .choices { margin: 10px 0; }
    .choice { display:flex; gap:10px; padding:10px; border:1px solid #eee; border-radius:12px; margin:8px 0; cursor:pointer; }
    .choice:hover { background: #fafafa; }
    .choice input { margin-top: 3px; }
    button { padding:10px 14px; border-radius:12px; border:1px solid #ddd; background:white; cursor:pointer; font-weight:600; }
    button:hover { background:#f6f6f6; }
    button.primary { background:#111; color:#fff; border-color:#111; }
    button.primary:hover { background:#222; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    .muted { opacity:.75; }
    .result { padding: 12px; border-radius: 12px; border: 1px solid #e9e9e9; background: #fbfbfb; margin-top: 12px; }
    .ok { border-color: #cfead6; background: #f3fbf5; }
    .bad { border-color: #ffd0d0; background: #fff5f5; }
    .timer { font-variant-numeric: tabular-nums; }
    .progress { height: 10px; background: #eee; border-radius: 999px; overflow:hidden; margin-top: 10px; }
    .progress > div { height:100%; width:0%; background:#111; transition: width .2s linear; }
    .footer { margin-top: 18px; display:flex; justify-content:space-between; gap: 12px; flex-wrap:wrap; }
    .small { font-size: 13px; }
    code { background:#f6f6f6; padding:2px 6px; border-radius:8px; }
  </style>
</head>
<body>

<h1>Quiz Matematică</h1>

<div class="topbar">
  <div class="badge" id="qCounter">Întrebarea 1 / 1</div>
  <div class="badge timer" id="timerBadge">⏳ Timp rămas: <span id="timeLeft">05:00</span></div>
</div>
<div class="progress" id="progressWrap"><div id="timeBar"></div></div>

<div id="app" class="card"></div>

<script>
  // === Întrebări (JSON-ul tău) ===
  const questions = [
    { "question": "Rezultatul calculului (2^0 + 2^1 + 2^2) : (2^3 - 1) este:", "choices": ["0", "1", "2", "4"], "answerIndex": 1, "explanation": "Avem 2^0=1, 2^1=2, 2^2=4. Suma lor este 7. De asemenea, 2^3 - 1 = 8 - 1 = 7. Împărțirea dă 7 : 7 = 1." },
    { "question": "După o reducere cu 10%, prețul unei cărți se micșorează cu 4 lei. Prețul cărții înainte de reducere era:", "choices": ["36 lei", "40 lei", "44 lei", "4,4 lei"], "answerIndex": 1, "explanation": "Reducerea de 10% reprezintă exact 4 lei. Ecuația este 10/100 * x = 4, de unde obținem prețul inițial x = 40 lei." },
    { "question": "Rezultatul calculului -12 + 12 : 12 este egal cu:", "choices": ["11", "0", "-11", "-12"], "answerIndex": 2, "explanation": "Se efectuează mai întâi operația de împărțire: 12 : 12 = 1. Apoi adunarea: -12 + 1 = -11." },
    { "question": "Cel mai mare număr întreg din intervalul [-5; 5) este:", "choices": ["6", "5", "4", "-5"], "answerIndex": 2, "explanation": "Intervalul este deschis la dreapta, deci 5 nu este inclus. Cel mai mare număr întreg cuprins în interval este 4." },
    { "question": "Rezultatul calculului 45 : 5 + (-2) * 2 este egal cu:", "choices": ["14", "22", "13", "5"], "answerIndex": 3, "explanation": "Efectuăm împărțirea și înmulțirea: 45 : 5 = 9 și (-2) * 2 = -4. Apoi 9 + (-4) = 5." },
    { "question": "Suma numerelor prime de o cifră este egală cu:", "choices": ["45", "17", "27", "26"], "answerIndex": 1, "explanation": "Numerele prime de o cifră sunt 2, 3, 5 și 7. Suma lor este 2 + 3 + 5 + 7 = 17." },
    { "question": "Cel mai mare divizor comun al numerelor 3 și 4 este:", "choices": ["3", "4", "1", "12"], "answerIndex": 2, "explanation": "Numerele 3 și 4 sunt prime între ele, așadar cel mai mare divizor comun al lor este 1." },
    { "question": "Suma numerelor naturale din intervalul (-5, 5) este:", "choices": ["-5", "0", "5", "10"], "answerIndex": 3, "explanation": "Numerele naturale din interval sunt 0, 1, 2, 3 și 4. Suma lor este 0 + 1 + 2 + 3 + 4 = 10." },
    { "question": "Dacă 20% dintr-un număr a este 50, atunci numărul a este egal cu:", "choices": ["10", "100", "25", "250"], "answerIndex": 3, "explanation": "Avem ecuația 20/100 * a = 50, ceea ce înseamnă 1/5 * a = 50, rezultând a = 50 * 5 = 250." },
    { "question": "Se consideră mulțimile A = {0, 1, 2, 4, 5, 7} și B = {2, 3, 4, 5, 6}. Reuniunea mulțimilor A și B este mulțimea:", "choices": ["{0, 1, 2, 3, 4, 5, 6}", "{0, 1, 2, 3, 4, 5, 6, 7}", "{0, 1, 3, 6, 7}", "{2, 4, 5}"], "answerIndex": 1, "explanation": "Reuniunea a două mulțimi este alcătuită din toate elementele acestora, luate o singură dată. Rezultă {0, 1, 2, 3, 4, 5, 6, 7}." },
    { "question": "Rezultatul calculului 84 : 6 - 4 * 3 este egal cu:", "choices": ["126", "30", "2", "14"], "answerIndex": 2, "explanation": "Se calculează mai întâi împărțirea și înmulțirea: 84 : 6 = 14 și 4 * 3 = 12. Apoi scăderea: 14 - 12 = 2." },
    { "question": "Suma dintre cel mai mic și cel mai mare număr natural divizibil cu 3 din intervalul [3; 18) este egală cu:", "choices": ["21", "18", "15", "12"], "answerIndex": 1, "explanation": "Cel mai mic multiplu de 3 din interval (închis la stânga) este 3. Cel mai mare, strict mai mic decât 18, este 15. Suma este 3 + 15 = 18." },
    { "question": "Numărul de numere întregi cuprinse între -2√2 și 2√3 este egal cu:", "choices": ["4", "5", "6", "7"], "answerIndex": 2, "explanation": "-2√2 = -√8 (situat între -3 și -2) și 2√3 = √12 (situat între 3 și 4). Întregii cuprinși sunt -2, -1, 0, 1, 2, 3, în total 6 numere." },
    { "question": "Cel mai mare număr natural care împărțit la 8 dă câtul 17, este:", "choices": ["136", "143", "137", "140"], "answerIndex": 1, "explanation": "Conform teoremei împărțirii cu rest, numărul n = 8 * 17 + r, cu r < 8. Restul maxim posibil este 7, deci numărul maxim este 136 + 7 = 143." },
    { "question": "Rezultatul calculului 0,2 - 2 : 100 este egal cu:", "choices": ["0", "0,08", "0,28", "0,18"], "answerIndex": 3, "explanation": "Efectuăm întâi împărțirea: 2 : 100 = 0,02. Apoi scăderea dă 0,2 - 0,02 = 0,18." },
    { "question": "Numărul natural n verifică relația 1/2 < (n+2)/4 < 5/3 dacă și numai dacă n face parte din mulțimea:", "choices": ["{0, 1, 2, 3, 4}", "{1, 2, 3, 4}", "{1, 2, 3}", "{2, 3, 4}"], "answerIndex": 1, "explanation": "Aducând la același numitor comun sau multiplicând totul cu 12, obținem 6 < 3n + 6 < 20, adică 0 < 3n < 14. Pentru n natural, soluțiile sunt {1, 2, 3, 4}." },
    { "question": "Rezultatul calculului 5^2 + 5^2 * 3 este egal cu:", "choices": ["300", "150", "100", "30"], "answerIndex": 2, "explanation": "Avem 25 + 25 * 3 = 25 + 75 = 100." },
    { "question": "Se consideră mulțimea A = {1, 2, 3, ..., 90}. Probabilitatea ca alegând la întâmplare un număr din mulțimea A acesta să fie pătrat perfect este:", "choices": ["4/45", "1/10", "5/9", "9/10"], "answerIndex": 1, "explanation": "Pătratele perfecte până la 90 sunt 1, 4, 9, 16, 25, 36, 49, 64, 81 (9 cazuri favorabile). Probabilitatea este 9/90 = 1/10." },
    { "question": "Suma tuturor numerelor naturale, care sunt divizori ai numărului 24, este egală cu:", "choices": ["50", "54", "56", "60"], "answerIndex": 3, "explanation": "Divizorii naturali ai lui 24 sunt 1, 2, 3, 4, 6, 8, 12, 24. Suma lor este 60." },
    { "question": "Suma soluțiilor ecuației |2x + 3| = 7 este:", "choices": ["3", "-2", "-3", "2"], "answerIndex": 2, "explanation": "Avem două cazuri: 2x+3=7 (x=2) și 2x+3=-7 (x=-5). Suma lor este 2 + (-5) = -3." },
    { "question": "Produsul numerelor -2 și 5 este egal cu:", "choices": ["-10", "-3", "3", "10"], "answerIndex": 0, "explanation": "Înmulțirea unui număr negativ cu un număr pozitiv are un rezultat negativ. (-2) * 5 = -10." },
    { "question": "Soluția ecuației 6x - 2 = 1 este numărul:", "choices": ["-1/3", "-1/2", "1/3", "1/2"], "answerIndex": 3, "explanation": "Trecând -2 în membrul drept cu semn schimbat obținem 6x = 1 + 2, deci 6x = 3. Rezultă x = 3/6 = 1/2." },
    { "question": "Cel mai mare număr întreg de două cifre este:", "choices": ["-99", "-10", "10", "99"], "answerIndex": 3, "explanation": "Numerele întregi includ și numerele pozitive. Cel mai mare număr pozitiv format din exact două cifre este 99." },
    { "question": "Dintre numerele 7/2, 7/3, 7/4 și 7/5, cel mai mic este:", "choices": ["7/5", "7/4", "7/3", "7/2"], "answerIndex": 0, "explanation": "Fracțiile au același numărător. Fracția care are cel mai mare numitor va avea cea mai mică valoare: 7/5." },
    { "question": "Media geometrică a numerelor 2√5 și 4√5 este:", "choices": ["2√10", "10√2", "3√5", "40"], "answerIndex": 0, "explanation": "Media geometrică se calculează astfel: √(2√5 * 4√5) = √(8 * 5) = √40 = 2√10." }
  ];

  const app = document.getElementById("app");
  const qCounter = document.getElementById("qCounter");
  const timeBar = document.getElementById("timeBar");
  const timerBadge = document.getElementById("timerBadge");
  const progressWrap = document.getElementById("progressWrap");

  // === CERINȚĂ: 5 minute / întrebare ===
  const TIME_PER_Q = 5 * 60; // sec
  let idx = 0;
  let score = 0;
  let timer = null;
  let remaining = TIME_PER_Q;
  let locked = false;

  function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

  function grade1to10(correct, total) {
    if (total <= 0) return 1;
    const ratio = correct / total;
    const g = 1 + ratio * 9; // 0% -> 1, 100% -> 10
    return Math.round(g * 100) / 100;
  }

  function stopTimer(){
    if (timer) { clearInterval(timer); timer = null; }
  }

  function escapeHtml(s){
    return String(s)
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  }

  function formatText(raw) {
    return escapeHtml(raw);
  }

  function fmtTime(seconds){
    const m = Math.floor(seconds / 60);
    const s = seconds % 60;
    return String(m).padStart(2,"0") + ":" + String(s).padStart(2,"0");
  }

  function startTimer(){
    stopTimer();
    remaining = TIME_PER_Q;

    progressWrap.style.display = "block";
    timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">${fmtTime(remaining)}</span>`;
    timeBar.style.width = "100%";

    timer = setInterval(() => {
      remaining -= 1;
      const tl = document.getElementById("timeLeft");
      if (tl) tl.textContent = fmtTime(Math.max(remaining, 0));

      const pct = (remaining / TIME_PER_Q) * 100;
      timeBar.style.width = clamp(pct, 0, 100) + "%";

      if (remaining <= 0) {
        stopTimer();
        revealAnswer(null, true);
      }
    }, 1000);
  }

  function renderQuestion(){
    locked = false;
    const q = questions[idx];
    qCounter.textContent = `Întrebarea ${idx + 1} / ${questions.length}`;

    app.innerHTML = `
      <h2>${formatText(q.question)}</h2>
      <div class="choices">
        ${q.choices.map((c, i) => `
          <label class="choice">
            <input type="radio" name="choice" value="${i}">
            <span>${formatText(c)}</span>
          </label>
        `).join("")}
      </div>
      <div class="row">
        <button class="primary" id="submitBtn">Trimite răspuns</button>
        <button id="skipBtn">Nu știu / sari</button>
      </div>
      <div id="feedback"></div>
      <div class="footer small muted">
        <div>Scor curent: <b id="scoreNow">${score}</b> / ${questions.length}</div>
        <div>Timp / întrebare: <code>${fmtTime(TIME_PER_Q)}</code></div>
      </div>
    `;

    document.getElementById("submitBtn").onclick = () => {
      if (locked) return;
      const picked = app.querySelector('input[name="choice"]:checked');
      if (!picked) {
        document.getElementById("feedback").innerHTML = `<div class="result">Alege un răspuns înainte să trimiți.</div>`;
        return;
      }
      revealAnswer(Number(picked.value), false);
    };

    document.getElementById("skipBtn").onclick = () => {
      if (locked) return;
      revealAnswer(null, false);
    };

    startTimer();
  }

  function revealAnswer(selectedIndex, timedOut){
    locked = true;
    stopTimer();

    const q = questions[idx];
    const correct = q.answerIndex;
    const isCorrect = (selectedIndex === correct);

    if (isCorrect) score += 1;

    const pickedText = (selectedIndex === null)
      ? (timedOut ? "⏰ Timpul a expirat." : "Ai sărit întrebarea.")
      : `Ai ales: <b>${formatText(q.choices[selectedIndex])}</b>`;

    const status = isCorrect ? "✅ Corect" : "❌ Greșit";
    const boxClass = isCorrect ? "result ok" : "result bad";

    document.getElementById("feedback").innerHTML = `
      <div class="${boxClass}">
        <div style="font-size:16px; margin-bottom:6px;"><b>${status}</b></div>
        <div>${pickedText}</div>
        <div style="margin-top:8px;">
          Răspuns corect: <b>${formatText(q.choices[correct])}</b>
        </div>
        <div style="margin-top:8px; opacity:.9">
          Explicație: ${formatText(q.explanation || "(fără explicație)")}
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button class="primary" id="nextBtn">${idx < questions.length - 1 ? "Următoarea întrebare" : "Vezi rezultatul final"}</button>
      </div>
    `;

    const scoreNow = document.getElementById("scoreNow");
    if (scoreNow) scoreNow.textContent = score;

    document.getElementById("nextBtn").onclick = () => {
      idx += 1;
      if (idx < questions.length) renderQuestion();
      else renderFinal();
    };
  }

  function renderFinal(){
    stopTimer();
    qCounter.textContent = "Final";
    timerBadge.innerHTML = `⏳ Timp rămas: <span id="timeLeft">—</span>`;
    progressWrap.style.display = "none";

    const total = questions.length;
    const nota = grade1to10(score, total);

    app.innerHTML = `
      <h2>Rezultat final</h2>
      <div class="result ok">
        <div>Răspunsuri corecte: <b>${score}</b> / <b>${total}</b></div>
        <div style="margin-top:8px;">Notă: <b>${nota}</b> / 10</div>
      </div>
      <div class="row" style="margin-top:12px;">
        <button class="primary" id="restartBtn">Reîncepe quiz-ul</button>
      </div>
      <p class="small muted" style="margin-top:10px;">
        Notarea este proporțională: 0% = 1, 100% = 10.
      </p>
    `;

    document.getElementById("restartBtn").onclick = () => {
      idx = 0;
      score = 0;
      renderQuestion();
    };
  }

  renderQuestion();
</script>

</body>
</html>
